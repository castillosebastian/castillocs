<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Retrieval-augmented generation for Chatbot - CastilloS</title><meta name="Description" content="This is my cool site"><meta property="og:url" content="http://localhost:1313/documents_qa/">
  <meta property="og:site_name" content="CastilloS">
  <meta property="og:title" content="Retrieval-augmented generation for Chatbot">
  <meta property="og:description" content="I developed a chatbot-like agent that utilizes Retrieval-Augmented Generation, integrating a pre-trained sequence-to-sequence model with a document database. This innovative synergy facilitates the creation of a question-answering application, which is capable of delivering contextually relevant and accurate responses by querying specific information.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-09-01T00:00:00+00:00">
    <meta property="article:tag" content="Chatbot">
    <meta property="article:tag" content="LLM">
    <meta property="article:tag" content="Question-Answering">
    <meta property="og:image" content="http://localhost:1313/documents_qa/featured-image.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/documents_qa/featured-image.jpg">
  <meta name="twitter:title" content="Retrieval-augmented generation for Chatbot">
  <meta name="twitter:description" content="I developed a chatbot-like agent that utilizes Retrieval-Augmented Generation, integrating a pre-trained sequence-to-sequence model with a document database. This innovative synergy facilitates the creation of a question-answering application, which is capable of delivering contextually relevant and accurate responses by querying specific information.">
      <meta name="twitter:site" content="@clausecastillo">
<meta name="application-name" content="castillos">
<meta name="apple-mobile-web-app-title" content="castillos"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/documents_qa/" /><link rel="prev" href="http://localhost:1313/responsible_ai/" /><link rel="next" href="http://localhost:1313/variational_autoencoders/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Retrieval-augmented generation for Chatbot",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/documents_qa\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "http:\/\/localhost:1313\/documents_qa\/featured-image.jpg",
                            "width":  4534 ,
                            "height":  3023 
                        }],"genre": "posts","keywords": "chatbot, llm, question-answering","wordcount":  3261 ,
        "url": "http:\/\/localhost:1313\/documents_qa\/","datePublished": "2023-09-01T00:00:00+00:00","dateModified": "2023-09-01T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "xxxx"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="CastilloS">CastilloS</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/aplications/"> Aplications </a><a class="menu-item" href="https://github.com/castillosebastian/castillocs" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/documents_qa/" selected>English</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="CastilloS">CastilloS</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/aplications/" title="">Aplications</a><a class="menu-item" href="https://github.com/castillosebastian/castillocs" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item language" title="Select Language">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/documents_qa/" selected>English</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Retrieval-augmented generation for Chatbot</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>xxxx</a></span>&nbsp;<span class="post-category">included in <a href="/categories/chatbot+/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Chatbot+</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-09-01">2023-09-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;3261 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;16 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/documents_qa/featured-image.jpg"
        data-srcset="/documents_qa/featured-image.jpg, /documents_qa/featured-image.jpg 1.5x, /documents_qa/featured-image.jpg 2x"
        data-sizes="auto"
        alt="/documents_qa/featured-image.jpg"
        title="/documents_qa/featured-image.jpg" /></div><div class="details toc" id="toc-static"  data-kept="true">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#chatbot-and-data-base">Chatbot and Data Base</a></li>
    <li><a href="#dataset-overview">Dataset Overview</a></li>
    <li><a href="#solutions-architecture">Solution&rsquo;s Architecture</a></li>
    <li><a href="#evaluation">Evaluation</a></li>
    <li><a href="#experiments-cpu">Experiments: CPU</a></li>
    <li><a href="#experiments-gpu">Experiments: GPU</a></li>
    <li><a href="#python-llama2-and-huggingface">Python, LLama2 and HuggingFace</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>I developed a chatbot-like agent that utilizes Retrieval-Augmented Generation, integrating a pre-trained sequence-to-sequence model with a document database. This innovative synergy facilitates the creation of a question-answering application, which is capable of delivering contextually relevant and accurate responses by querying specific information.</p>
<h2 id="chatbot-and-data-base">Chatbot and Data Base</h2>
<p>In the advanced domain of Natural Language Processing (NLP), large pre-trained language models have become pivotal tools, showcasing superior performance in embedding factual knowledge and achieving state-of-the-art outcomes on various downstream tasks. However, these models exhibit constraints, particularly in their ability to accurately access and manipulate knowledge. Such limitations become evident in knowledge-intensive tasks, where their efficacy can be surpassed by specialized architectures.</p>
<p>In this context, I constructed a prototype to explore this technology. My goal was to integrate the capabilities of pre-trained parametric memory with the expansive nature of non-parametric one. Thus, I developed a chatbot with access to a knowledge base. Utilizing retrieval-augmented generation, this system incorporates a pre-trained seq2seq model as its parametric memory and a dense vector index of documents as its non-parametric counterpart.</p>
<h2 id="dataset-overview">Dataset Overview</h2>
<p>The chosen dataset come from the VAST 2014 Challenge <em>The Kronos Incident</em>. The 2014 IEEE Visual Analytics Science and Technology (VAST) Challenge researchers with a fictional scenario: the disappearance of staff members from the GASTech oil and gas company on Kronos Island. The dataset comprises:</p>
<ul>
<li><strong>Geospatial Data</strong>: Geographic coordinates, maps, event locations, trajectories of vehicles or individuals.</li>
<li><strong>Temporal Data</strong>: Time series, timestamps, chronological events.</li>
<li><strong>Network Data</strong>: Information on connections between entities, such as phone calls, social media interactions, data traffic flows.</li>
<li><strong>Textual Data</strong>: Information in text form, like emails, chat logs, incident reports, etc.</li>
<li><strong>Numerical Data</strong>: Numeric values that might be related to the incident, such as counts, measurements, quantities.</li>
</ul>
<p>A total of 845 emails, 39 Word documents, 2 Excel sheets, and 1 CSV text file were processed to construct a vector database comprising 887 documents.</p>
<h2 id="solutions-architecture">Solution&rsquo;s Architecture</h2>
<p>The project is challenging as it proposes the construction of a complex system, comprised of two textual data processing modules, each with its respective language models. The final system outcome is conditioned by the performance of both modules individually and their correct integration. Several experiments were conducted, adjusting the model composition and also switching the computing architecture from CPU to GPU. Two system versions were built, with a third variation for GPU processing.</p>
<blockquote>
<p><strong>Architecture Overview</strong></p></blockquote>
<p>The architecture consists of two major components:</p>
<p><strong>1. Searcher</strong></p>
<p>Its primary goal is to find fragments of text within the corpus that can be used to answer the user-generated question. For our searcher module, we utilized <code>all-MiniLM-L6-v2</code>, developed by Google AI. This language model, based on transformers, has 137 billion parameters and is an enhanced version of the <code>MiniLM-L6</code> model. It&rsquo;s smaller and lighter than the BERT model. It&rsquo;s trained on a massive dataset that includes books, articles, code, and other forms of text.</p>
<p><strong>2. Generator</strong></p>
<p>Focused on text construction.The generation module is built using <code>Llama 2</code>, developed by Meta AI. This LLM (Language Learning Model) is a pre-trained transformer model that can be used for various tasks, including translation, summarization, crafting different types of creative content, and informatively answering questions. Due to the model&rsquo;s size, we used a quantized version of <code>Llama 2</code> for our application. Quantization is the technique that reduces the number of bits used to represent a number or value. In the context of LLMs, this means decreasing the precision of the model&rsquo;s parameters by storing the weights in lower precision data types. Specifically, the original values, encoded in 16 bits, were converted to 8 bits.</p>
<blockquote>
<p><strong>Question-Answering Solution Process</strong></p></blockquote>
<table>
  <thead>
      <tr>
          <th>Step</th>
          <th>Description</th>
          <th>Details</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>1. Input</strong></td>
          <td>Receive Question</td>
          <td>The system starts by receiving a question, denoted as <code>'p'</code>.</td>
      </tr>
      <tr>
          <td><strong>2. Vectorization</strong></td>
          <td>Convert Question to Vector</td>
          <td>The question <code>'p'</code> is transformed into its vectorized form.</td>
      </tr>
      <tr>
          <td><strong>3. Document Search</strong></td>
          <td>Match Question with Documents</td>
          <td>The vectorized question is compared against the documents in the corpus <code>'C'</code> to find potential matches.</td>
      </tr>
      <tr>
          <td><strong>4. Identify Relevant Documents</strong></td>
          <td>Select Documents `[d1,d2]``</td>
          <td>Based on the similarity scores, the system identifies the most relevant documents from the corpus that might contain the answer.</td>
      </tr>
      <tr>
          <td><strong>5. Generate Answer</strong></td>
          <td>Provide Response</td>
          <td>The system generates an answer based on the content of the most similar documents.</td>
      </tr>
  </tbody>
</table>
<p>The solution addresses the Question-Answering problem in two steps. It first operates on a vectorized database of our corpus <code>C</code>, where each 500-character document has its associated embedding. The search is performed based on similarity between the vectorized question <code>p</code> and the corpus documents <code>[d1,...,dN]</code> using their respective indices. For similarity calculation, we use the Euclidean distance between vectors with the L2 norm (vector subtraction, where the resulting vector&rsquo;s L2 norm gives us the distance between them: the smaller the distance, the greater the similarity).</p>
<div class="details admonition info">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Embeddings<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><h3 id="embeddings">Embeddings</h3>
<p>Embeddings are a type of word representation that captures the semantic meaning of words based on their context in a high-dimensional space. They are vectors of real numbers where words with similar meanings have similar embeddings. The idea is to represent words in a dense vector space where the position of each word is learned from its context in a large dataset. One of the most popular methods to generate embeddings is through neural networks, such as Word2Vec, GloVe, and FastText.</p>
<p>Mathematically, an embedding for a word $w$ can be represented as:</p>
<blockquote>
<p>$$e(w) = [e_1, e_2, &hellip;, e_n]$$</p></blockquote>
<p>Where:</p>
<ul>
<li>$e(w)$ is the embedding of the word $w$.</li>
<li>$e_1, e_2, &hellip;, e_n$ are the components of the embedding in the $n$-dimensional space.</li>
</ul>
<h3 id="euclidean-distance-for-similarity-search">Euclidean Distance for Similarity Search</h3>
<p>Euclidean distance is a measure of the straight-line distance between two points in Euclidean space. It&rsquo;s commonly used to measure the similarity between vectors, such as embeddings. The idea is that the closer two vectors are in this space, the more similar they are.</p>
<p>Given two points $P$ and $Q$ with coordinates $(p_1, p_2, &hellip;, p_n)$ and $(q_1, q_2, &hellip;, q_n)$ respectively in an $n$-dimensional space, the Euclidean distance $d$ between them is given by:</p>
<blockquote>
<p>$$d(P, Q) = \sqrt{(p_1 - q_1)^2 + (p_2 - q_2)^2 + &hellip; + (p_n - q_n)^2}$$</p></blockquote>
<p>In the context of similarity search, smaller Euclidean distances indicate higher similarity. When using embeddings for similarity search, the embeddings of two words or documents are compared using the Euclidean distance to determine how semantically similar they are.</p>
</div>
        </div>
    </div>
<p>After this stage, we proceed to a second step which involves generating an answer <code>r</code> conditioned on the retrieved information. The generation takes the question <code>p</code> and the 2 most similar documents (smallest distance), combines them into a single <code>question-context</code> (prompt) document, and passes it to a language generation model to formulate the answer <code>r</code>. In this final step, we are using Llama2 with 7 billion parameters, optimized for Question-Answering (chat).</p>
<div class="details admonition info">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>Large Language Models<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><h3 id="large-language-models-llms">Large Language Models (LLMs)</h3>
<p>Large Language Models (LLMs) are a type of deep learning model designed to understand and generate human-like text. They are trained on vast amounts of text data and have the capacity to generate coherent and contextually relevant sentences over long passages. The &ldquo;large&rdquo; in LLMs refers to the number of parameters these models have, often ranging from hundreds of millions to tens of billions.</p>
<p>Mathematically, an LLM can be represented as a function $f$ that maps an input sequence of tokens $x_1, x_2, &hellip;, x_n$ to an output sequence of tokens $y_1, y_2, &hellip;, y_m$:</p>
<blockquote>
<p>$$f: (x_1, x_2, &hellip;, x_n) \rightarrow (y_1, y_2, &hellip;, y_m)$$</p></blockquote>
<p>Where:</p>
<ul>
<li>$(x_1, x_2, &hellip;, x_n)$ is the input sequence.</li>
<li>$(y_1, y_2, &hellip;, y_m)$ is the output sequence.</li>
<li>$f$ is the function representing the LLM.</li>
</ul>
<h3 id="llama-2">Llama 2</h3>
<p>Llama 2 is an advanced iteration of Large Language Models developed with a focus on chat and dialogue use cases. It consists of a collection of pretrained and fine-tuned LLMs ranging in scale from 7 billion to 70 billion parameters. The fine-tuned versions, known as Llama 2-Chat, are specifically optimized for dialogue scenarios.</p>
<p>Key features of Llama 2 include:</p>
<ul>
<li><strong>Scale:</strong> Models range from 7 billion to 70 billion parameters, allowing for a wide variety of applications and use cases.</li>
<li><strong>Performance:</strong> Llama 2 models outperform many open-source chat models on several benchmarks.</li>
<li><strong>Fine-tuning:</strong> Llama 2-Chat models are fine-tuned to be optimized for dialogue use cases, ensuring coherent and contextually relevant responses in conversational scenarios.</li>
<li><strong>Safety:</strong> Significant efforts have been made to ensure that Llama 2-Chat models are safe and provide helpful responses. This is based on human evaluations for helpfulness and safety.</li>
<li><strong>Open Development:</strong> A detailed description of the approach to fine-tuning and safety improvements of Llama 2-Chat is provided, enabling the community to build upon and contribute to the responsible development of LLMs.</li>
</ul>
<p>In essence, Llama 2 represents a significant step forward in the development of LLMs, especially for chat and dialogue applications. The emphasis on safety and the detailed documentation provided aim to ensure that the community can use and further develop these models responsibly. More details in: <a href="https://ai.meta.com/research/publications/llama-2-open-foundation-and-fine-tuned-chat-models/" target="_blank" rel="noopener noreffer ">https://ai.meta.com/research/publications/llama-2-open-foundation-and-fine-tuned-chat-models/</a></p>
</div>
        </div>
    </div>
<p>A primary challenge in implementing the described solution on a personal-type CPU (4 processors and 12GB of RAM) is the size of the models. For this reason, in Version 1 of our solution, we worked with the following specifications: for embedding operations (on <code>C</code> and <code>p</code>) we used the all-MiniLM-L6-v2 model that produces a dense 384-dimensional vector space. For the <code>r</code> answer generation operation, we worked with a quantized version of Llama 2, 7b, 8-bit (an exploratory attempt was made with the 13 billion parameter model, thwarted by lack of RAM). Similarity operations are performed using the FAISS library for efficient similarity search among dense vectors.</p>
<h2 id="evaluation">Evaluation</h2>
<p>To evaluate our model, several Question-Answering experiments were conducted, taking the answers provided as a solution to the Vast-Challenge competition as the ground truth. That is, we compared the answers formulated by analysts who participated in the competition with the answers provided by our solution. For this comparison, we used cosine distance.</p>
<h2 id="experiments-cpu">Experiments: CPU</h2>
<p>Version 1 provides unsatisfactory results not only due to the answer content but also due to system latency, caused by the prolonged generation process. For example, we have this question-answer:</p>
<table>
  <thead>
      <tr>
          <th><strong>Question</strong></th>
          <th>&lsquo;What is the name of the young girl who dies and what are the causes of the death?&rsquo;</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Analyst&rsquo;s Answer</strong></td>
          <td>&lsquo;The name of the girl who died is Juliana Vann. The cause of death is a lingering illness, which WFA-funded doctors claimed was caused by water contamination.’</td>
      </tr>
      <tr>
          <td><strong>Our Model&rsquo;s Answer</strong></td>
          <td>&lsquo;The name of the young girl who died is Elodis. The cause of death is leukemia due to benzene poisoning.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Cosine Similarity</strong></td>
          <td>0.5957</td>
      </tr>
  </tbody>
</table>
<p>We see that the model fails to identify the girl, offering an answer with a similarity score of 0.59. This difficulty is associated with the retrieval module, particularly the document vectorization model. This is because, although the documents identified as similar to the question contained relevant information, they had a marginal treatment of the question&rsquo;s subject. Therefore, the failure in the generator model is strongly conditioned by the context that served as input. In addition to the above, the delay in formulating the answer was 272 seconds, which is unfeasible for a solution like ours.</p>
<p>Given these difficulties, we implemented a Version 2 of the solution with the following transformations. We replaced the all-MiniLM-L6-v2 model with the gte-base, which scored higher on the Overall MTEB English leaderboard. With this, we not only sought to improve the representation of the documents to favor the search but also the transformation of the question for similarity analysis. Several adjustments were made to the solution architecture to improve execution time, considering that 0.62% of the delay is in the generation module. With these transformations, we obtained the following results:</p>
<table>
  <thead>
      <tr>
          <th><strong>Question</strong></th>
          <th>&lsquo;What is the name of the young girl who dies and what are the causes of the death?&rsquo;</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Analyst&rsquo;s Answer</strong></td>
          <td>&lsquo;The name of the girl who died is Juliana Vann. The cause of death is a lingering illness, which WFA-funded doctors claimed was caused by water contamination.’</td>
      </tr>
      <tr>
          <td><strong>Our Model&rsquo;s Answer</strong></td>
          <td>&lsquo;The name of the young girl who died is Juliana Vann, and the cause of her death is a lingering illness caused by water contamination according to WFA-funded doctors.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Cosine Similarity</strong></td>
          <td>0.9747</td>
      </tr>
  </tbody>
</table>
<p>The improvement in the answer content was accompanied by a reduction in system latency, which lasted 163 seconds (+- 20). A series of experiments were conducted with questions that implied extractive and generative answers, with promising results in both cases. Therefore, we took a further step, reconfiguring the entire architecture to run in a GPU environment.</p>
<h2 id="experiments-gpu">Experiments: GPU</h2>
<p>Version 3 of the solution was readapted to run in a higher capacity environment on <strong>Google Colab</strong>, which implied significant changes. Although we kept the language models selected in Version 2, all processing performed in both modules was adjusted to run on GPU. Even the similarity calculation between the question and the database runs on GPU.</p>
<p>To evaluate this third version, we conducted 10 question-answer experiments. Regarding the question presented above, we obtained - as expected - the same answer obtained in Version 2 but with a latency reduction of -40 seconds. This is a positive result.</p>
<p>In another satisfactorily resolved question, we have these results:</p>
<table>
  <thead>
      <tr>
          <th><strong>Question</strong></th>
          <th>&lsquo;Where does the core of the kidnapping activities take place?&rsquo;</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Analyst&rsquo;s Answer</strong></td>
          <td>&lsquo;The kidnapping takes place at GASTech Headquarters in the southern part of Abila, Kronos.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Our Model&rsquo;s Answer</strong></td>
          <td>&lsquo;The core of the kidnapping activities takes place in the city of Kronos.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Cosine Similarity</strong></td>
          <td>0.7201</td>
      </tr>
  </tbody>
</table>
<p>More complex questions generally yielded unsatisfactory results. For example, in the following case, we formulated a question that assumes a significant level of synthesis and abstraction of the corpus documents that the model fails to resolve.</p>
<table>
  <thead>
      <tr>
          <th><strong>Question</strong></th>
          <th>&lsquo;What were the motivations behind the kidnapping carried out by the more violent wing of the POK?&rsquo;</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Analyst&rsquo;s Answer</strong></td>
          <td>&lsquo;The more violent wing of the POK under the leadership of Mandor Vann (uncle to Isia and Juliana Vann) were motivated to kidnap members of GASTech’s leadership to exact revenge for years of pollution that GASTech’s drilling operations have inflicted on the people of Elodis. Additional motivations include GASTech’s recent IPO which resulted in massive payouts for GASTech leadership, making them ripe for ransom. Another motivation for the kidnapping is the frustration with the corruption and lax environmental regulation of the Government of Kronos, personified by GASTech.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Our Model&rsquo;s Answer</strong></td>
          <td>&lsquo;The motivations behind the kidnapping carried out by the more violent wing of the POK are likely rooted in their anarchist ideology and a desire to create chaos and undermine the authority of the state. They may see this act as a way to further their goals of overthrowing the government and establishing a new society free from oppressive structures.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Cosine Similarity</strong></td>
          <td>0.5404</td>
      </tr>
  </tbody>
</table>
<p>The model captures a general idea of the topic but does not articulate an appropriate answer. It fails to identify motives, circumstances, and people. It suffers from a systematic phenomenon in generative models related to &lsquo;hallucination&rsquo;.</p>
<div class="details admonition info">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw" aria-hidden="true"></i>LLM`s challenges<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><h3 id="problems-with-large-language-models-llms">Problems with Large Language Models (LLMs)</h3>
<p>While Large Language Models (LLMs) have shown remarkable capabilities in understanding and generating human-like text, they are not without their challenges. One of the notable problems faced by LLMs is the phenomenon known as &ldquo;hallucination.&rdquo;</p>
<h3 id="hallucination-in-llms">Hallucination in LLMs</h3>
<p>Hallucination refers to the generation of information by the model that is not present or supported by the input data. In other words, the model &ldquo;makes up&rdquo; details or facts that are not grounded in reality or the provided context.</p>
<h4 id="causes">Causes:</h4>
<ol>
<li><strong>Training Data:</strong> LLMs are trained on vast amounts of data, and they might have encountered conflicting or incorrect information during training. This can lead them to generate outputs that are not always accurate.</li>
<li><strong>Model Complexity:</strong> The sheer number of parameters in LLMs can sometimes lead to overfitting, where the model might generate outputs based on patterns it &ldquo;thinks&rdquo; it has learned, even if they aren&rsquo;t valid.</li>
<li><strong>Lack of Ground Truth:</strong> Unlike supervised learning where there&rsquo;s a clear ground truth, LLMs often operate in settings where the &ldquo;correct&rdquo; output is ambiguous, leading to potential hallucinations.</li>
</ol>
<h4 id="implications">Implications:</h4>
<ul>
<li><strong>Misinformation:</strong> Hallucination can lead to the spread of false or misleading information, especially if users trust the model&rsquo;s outputs without verification.</li>
<li><strong>Reliability:</strong> For critical applications, hallucinations can undermine the reliability of the model, making it unsuitable for tasks that require high precision.</li>
</ul>
<h4 id="solutions">Solutions:</h4>
<ol>
<li><strong>Fine-tuning:</strong> Fine-tuning the model on a narrower, domain-specific dataset can help reduce hallucinations by making the model more specialized.</li>
<li><strong>Prompt Engineering:</strong> Designing prompts carefully can guide the model to produce more accurate and less hallucinatory outputs.</li>
<li><strong>Model Interpretability:</strong> Developing tools and techniques to understand why a model is producing a particular output can help in identifying and mitigating hallucinations.</li>
</ol>
<p>In conclusion, while LLMs offer significant advancements in natural language processing, it&rsquo;s essential to be aware of their limitations, such as hallucination. Proper understanding, fine-tuning, and continuous monitoring are crucial to harnessing their potential responsibly.</p>
</div>
        </div>
    </div>
<p>However, the reason for the failure is not attributable to the results of the modules considered individually but to the solution in general. In effect, if we analyze the elements of this third experiment, we will find that the answer has a pertinent relationship with the available information, i.e., &lsquo;question + context -&gt; answer&rsquo; are acceptable, although the final result does not relate to the truth as formulated by analysts. This is because: a) the retrieval module only takes 2 documents as relevant context information due to a model limit, leaving with partial information, b) this partial information is strongly conditioned by the bias that the information has, which translates into a text with categorical and polarizing terms, and c) the decontextualization that needs to be performed for the generation instance lacks a weighting or rebalancing strategy of the corpus&rsquo;s structuring semantic contents and therefore reproduces a partial and decontextualized idea of its information.</p>
<p>A significant number of conducted experiments show critical solution failures. They particularly point to poor performance of the retrieval module. In these cases, the model responds that it &lsquo;does not have information to answer the question (&lsquo;I don&rsquo;t know&hellip;&rsquo;). That is, the modules conflict, arriving at an unacceptable result.</p>
<table>
  <thead>
      <tr>
          <th><strong>Question</strong></th>
          <th>&lsquo;&lsquo;On what date do the microblog collection days occur&rsquo;?&rsquo;</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Analyst&rsquo;s Answer</strong></td>
          <td>&lsquo;January 23, 2014. The microblog collection days that include (at least) three major events related to the scenario.&rsquo;</td>
      </tr>
      <tr>
          <td><strong>Our Model&rsquo;s Answer</strong></td>
          <td>&lsquo;I don&rsquo;t know the answer to that question, I&rsquo;m just an AI and do not have access to the specific information you are seeking.&rsquo;</td>
      </tr>
  </tbody>
</table>
<p>Finally, other experiments failed because they arrived at answers that deviate from the truth. In these cases, a failure in the retrieval module can also be observed.</p>
<h2 id="python-llama2-and-huggingface">Python, LLama2 and HuggingFace</h2>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-python">
        <span class="code-title"><i class="arrow fas fa-chevron-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">box</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">timeit</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">yaml</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">argparse</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">find_dotenv</span><span class="p">,</span> <span class="n">load_dotenv</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">src.utils</span> <span class="kn">import</span> <span class="n">setup_dbqa</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">torch</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">langchain.embeddings</span> <span class="kn">import</span> <span class="n">HuggingFaceEmbeddings</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Load environment variables from .env file</span>
</span></span><span class="line"><span class="cl"><span class="n">load_dotenv</span><span class="p">(</span><span class="n">find_dotenv</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gpu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Import config vars</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;config/config.yml&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ymlfile</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cfg</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">ymlfile</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">gpu</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl">    <span class="n">embeddings</span> <span class="o">=</span> <span class="n">HuggingFaceEmbeddings</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&#34;thenlper/gte-base&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                           <span class="n">model_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cuda&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">embeddings</span> <span class="o">=</span> <span class="n">HuggingFaceEmbeddings</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">&#34;thenlper/gte-base&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                       <span class="n">model_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;device&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu&#39;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">default</span><span class="o">=</span><span class="s1">&#39;What were the motivations behind the kidnapping carried out by the more violent wing of the POK?&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Enter the query to pass into the LLM&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Setup DBQA</span>
</span></span><span class="line"><span class="cl">    <span class="n">start</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">dbqa</span> <span class="o">=</span> <span class="n">setup_dbqa</span><span class="p">(</span><span class="n">embeddings</span><span class="o">=</span><span class="n">embeddings</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">dbqa</span><span class="p">({</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">input</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">end</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">default_timer</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Answer: </span><span class="si">{</span><span class="n">response</span><span class="p">[</span><span class="s2">&#34;result&#34;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Process source documents</span>
</span></span><span class="line"><span class="cl">    <span class="n">source_docs</span> <span class="o">=</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;source_documents&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">source_docs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Source Document </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Source Text: </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">page_content</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Document Name: </span><span class="si">{</span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&#34;source&#34;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#print(f&#39;Page Number: {doc.metadata[&#34;page&#34;]}\n&#39;)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">#</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Time to retrieve response: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span></span></span></code></pre></div></div>
<div class="details admonition note">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>Bib<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>Touvron, H. et al. (2023). Llama 2: Open Foundation and Fine-Tuned Chat Models. arXiv:2307.09288. <a href="https://arxiv.org/abs/2307.09288" target="_blank" rel="noopener noreffer ">https://arxiv.org/abs/2307.09288</a>.</li>
<li>Lewis, P. et al. (2021). Retrieval-Augmented Generation for Knowledge-Intensive NLP Tasks. arXiv:2005.11401 <a href="https://arxiv.org/abs/2005.11401" target="_blank" rel="noopener noreffer ">https://arxiv.org/abs/2005.11401</a>.</li>
<li>Faiss is a library for efficient similarity search and clustering of dense vectors, <a href="https://github.com/facebookresearch/faiss" target="_blank" rel="noopener noreffer ">https://github.com/facebookresearch/faiss</a>.</li>
<li>HuggingFace, <a href="https://huggingface.co/" target="_blank" rel="noopener noreffer ">https://huggingface.co/</a>.</li>
</ul>
</div>
        </div>
    </div>
<p>Pic by <a href="https://unsplash.com/es/fotos/yEQ9TOaL5FM?utm_source=unsplash&utm_medium=referral&utm_content=creditShareLink">@Luke Tanis</a></p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-09-01</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/documents_qa/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot" data-via="clausecastillo" data-hashtags="chatbot,llm,question-answering"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/documents_qa/" data-hashtag="chatbot"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/documents_qa/" data-title="Retrieval-augmented generation for Chatbot" data-description=""><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fdocuments_qa%2f&amp;text=Retrieval-augmented%20generation%20for%20Chatbot" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/chatbot/">Chatbot</a>,&nbsp;<a href="/tags/llm/">LLM</a>,&nbsp;<a href="/tags/question-answering/">Question-Answering</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/responsible_ai/" class="prev" rel="prev" title="Responsible AI Tools"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Responsible AI Tools</a>
            <a href="/variational_autoencoders/" class="next" rel="next" title="Generative Models: Variational Autoencoders">Generative Models: Variational Autoencoders<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">xxxx</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/algoliasearch/lite/browser.umd.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/lightgallery/lightgallery.min.js"></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/contrib/auto-render.min.js"></script><script src="/lib/katex/contrib/copy-tex.min.js"></script><script src="/lib/katex/contrib/mhchem.min.js"></script><script src="/lib/cookieconsent/cookieconsent.min.js"></script><script>window.config={"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script src="/js/theme.min.js"></script></body>
</html>
